<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Michael Mayer">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Flash tool - Sduino</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Sduino</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../..">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../install/">Installation</a>
                        </li>
                    
                        <li >
                            <a href="../../sdcc/">Using the SDCC compiler</a>
                        </li>
                    
                        <li >
                            <a href="../../spl/">Using the SPL with SDCC and sduino</a>
                        </li>
                    
                        <li >
                            <a href="../../macro/">C preprocessor macro magic</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Libraries <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../api/">API description and migration guidelines</a>
                        </li>
                    
                        <li >
                            <a href="../../api/HardwareSerial/">HardwareSerial</a>
                        </li>
                    
                        <li >
                            <a href="../../api/SPI/">SPI</a>
                        </li>
                    
                        <li >
                            <a href="../../api/I2C/">I2C</a>
                        </li>
                    
                        <li >
                            <a href="../../api/LiquidCrystal/">LiquidCrystal character LCD library</a>
                        </li>
                    
                        <li >
                            <a href="../../api/PCD8544/">PCD8544 libray for Nokia 5110-like graphical LCDs</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Mini_SSD1306/">Mini_SSD1306 library for monochrome OLED-displays</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Stepper/">Stepper library</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Servo/">Servo library</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hardware <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li class="active">
                            <a href="./">Flash tool</a>
                        </li>
                    
                        <li >
                            <a href="../">List of supported boards</a>
                        </li>
                    
                        <li >
                            <a href="../pin_mapping/">Ways to define a pin mapping</a>
                        </li>
                    
                        <li >
                            <a href="../stm8blue/">Generic STM8S103 breakout board (stm8blue)</a>
                        </li>
                    
                        <li >
                            <a href="../esp14/">ESP14: Wifi board, STM8S003</a>
                        </li>
                    
                        <li >
                            <a href="../stm8sdiscovery/">STM8S105Discovery: Evaluation board made my ST</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../about/">About</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../../api/Servo/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/tenbaht/sduino">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#flash-tool">Flash tool</a></li>
        
            <li><a href="#pinout">Pinout</a></li>
        
            <li><a href="#installation-for-linux">Installation for Linux</a></li>
        
            <li><a href="#connection-to-the-cpu-board">Connection to the CPU board</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="flash-tool">Flash tool</h1>
<p>You need a special flash tools in order to program the CPU. As far as I know
there is no third-party product or software that implements the needed
communication protocol. So you can't just use a regular Arduino board as a
flash tool as you could for the ATmega. But this is not a problem, as these
tools are are easily available and unbeliveably cheap (well under $3 on
aliexpress, search for st-link).</p>
<p>There are two versions of the ST-Link V2 compatible flash tool available:
One in a USB-Drive-like metal housing (often pink or blue) and one made by
Baite in a green plastic housing. Both work well, but they use a different
pinout.</p>
<p><img alt="Picture of both flash tools" src="../ST-LinkV2_pinout_01.jpg" /></p>
<p>Both flash tools support the SWIM protocol for STM8 CPUs and the SWD
protocol for the STM32 CPUs. The programmer from Baite additionally supports
JTAG and is slightly superior to the more common one in the metal housing.
More information on the hardware and the pinouts:
https://wiki.cuvoodoo.info/doku.php?id=jtag</p>
<h2 id="pinout">Pinout</h2>
<p>Pinout of Chinese ST-Link V2-clone made by Baite with green plasic housing
(supports SWIM, SWD and JTAG):</p>
<pre><code>            +-----+
    T_JRST  | 1  2| 3V3
    5V      | 3  4| T_JTCK/T_SWCLK
    SWIM      5  6| T_JTMS/T_SWDIO
    GND     | 7  8| T_JTDO
    SWIM RST| 9 10| T_JTDI
            +-----+
</code></pre>
<p>Pinout of Chinese ST-Link V2-clone with metal housing (supports SWIM and
SWD):</p>
<pre><code>            +-----+
    RST     | 1  2| SWDIO
    GND     | 3  4| GND
    SWIM      5  6| SWCLK
    3V3     | 7  8| 3V3
    5V      | 9 10| 5V
            +-----+
</code></pre>
<h2 id="installation-for-linux">Installation for Linux</h2>
<p>For Linux: required lines in /etc/udev/rules.d/99-stlink.rules:</p>
<pre><code># ST-Link/V2 programming adapter

# ST-Link V1, ST-Discovery boards
ATTR{idVendor}=="0483", ATTR{idProduct}=="3744", MODE="0666", GROUP="plugdev"

# ST-Link/V2, the china adapter with the green plastic housing
ATTR{idVendor}=="0483", ATTR{idProduct}=="3748", MODE="0666", GROUP="plugdev"
</code></pre>
<h2 id="connection-to-the-cpu-board">Connection to the CPU board</h2>
<p>The pinout of the SWIM connector P3 on my STM8S103 breakout board fits the
pinout of the flash tool in the metal housing perfectly:</p>
<table>
<thead>
<tr>
<th>Signal</th>
<th>SWIM connector P3</th>
<th>Baite ST-Link</th>
<th align="right">Metal ST-Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>3V3</td>
<td>1</td>
<td>2</td>
<td align="right">7</td>
</tr>
<tr>
<td>SWIM</td>
<td>2</td>
<td>5</td>
<td align="right">5</td>
</tr>
<tr>
<td>GND</td>
<td>3</td>
<td>7</td>
<td align="right">3</td>
</tr>
<tr>
<td>NRST</td>
<td>4</td>
<td>9</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>The Discovery boards made by ST all feature a ST-Link interface as well, but
only the Discovery STM8S105 supports the SWIM protocol. The Discovery
STM32F0308 implements SWD only and is not usable for the STM8.</p>
<table>
<thead>
<tr>
<th>Pin out CN3</th>
<th>SWD</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>? detect oder so?</td>
</tr>
<tr>
<td>2</td>
<td>JTCK/SWCLK</td>
</tr>
<tr>
<td>3</td>
<td>GND</td>
</tr>
<tr>
<td>4</td>
<td>JTMS/SWDIO</td>
</tr>
<tr>
<td>5</td>
<td>NRST</td>
</tr>
<tr>
<td>6</td>
<td>SWO</td>
</tr>
</tbody>
</table></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>