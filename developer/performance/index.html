<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Michael Mayer">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Performance comparison and benchmarking - Sduino</title>

        <link href="../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Sduino</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../..">Introduction</a>
                        </li>
                    
                        <li >
                            <a href="../../usage/board-manager-install/">Automatic Installation</a>
                        </li>
                    
                        <li >
                            <a href="../../usage/build-ide/">Building with the IDE</a>
                        </li>
                    
                        <li >
                            <a href="../../usage/why-stm8/">When to use an STM8S - and when not</a>
                        </li>
                    
                        <li >
                            <a href="../../usage/manual-install/">Manual Installation</a>
                        </li>
                    
                        <li >
                            <a href="../../usage/build-cli/">Building with a Makefile</a>
                        </li>
                    
                        <li >
                            <a href="../../usage/limitations/">Limitations</a>
                        </li>
                    
                        <li >
                            <a href="../../usage/status-todo/">Status and todo</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Libraries <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../api/migration/">API description and migration guidelines</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Print/">Print</a>
                        </li>
                    
                        <li >
                            <a href="../../api/HardwareSerial/">HardwareSerial</a>
                        </li>
                    
                        <li >
                            <a href="../../api/SPI/">SPI</a>
                        </li>
                    
                        <li >
                            <a href="../../api/I2C/">I2C</a>
                        </li>
                    
                        <li >
                            <a href="../../api/LiquidCrystal/">LiquidCrystal character LCD library</a>
                        </li>
                    
                        <li >
                            <a href="../../api/PCD8544/">PCD8544 libray for Nokia 5110-like graphical LCDs</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Mini_SSD1306/">Mini_SSD1306 library for monochrome OLED-displays</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Stepper/">Stepper library</a>
                        </li>
                    
                        <li >
                            <a href="../../api/Servo/">Servo library</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hardware <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../hardware/flashtool/">Flash tool</a>
                        </li>
                    
                        <li >
                            <a href="../../hardware/stm8blue/">Generic STM8S103 breakout board (stm8blue)</a>
                        </li>
                    
                        <li >
                            <a href="../../hardware/esp14/">ESP14: Wifi board, STM8S003</a>
                        </li>
                    
                        <li >
                            <a href="../../hardware/stm8sdiscovery/">STM8S105Discovery: Evaluation board made my ST</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developer Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../ide-integration/">IDE integration</a>
                        </li>
                    
                        <li >
                            <a href="../macro/">C preprocessor macro magic</a>
                        </li>
                    
                        <li >
                            <a href="../pin_mapping/">Ways to define a pin mapping</a>
                        </li>
                    
                        <li >
                            <a href="../sdcc/">Using the SDCC compiler</a>
                        </li>
                    
                        <li >
                            <a href="../spl/">Using the SPL with SDCC and sduino</a>
                        </li>
                    
                        <li >
                            <a href="../bare-metal-programming/">Bare metal programming on the STM8</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Performance comparison and benchmarking</a>
                        </li>
                    
                        <li >
                            <a href="../links/">Links and further reading</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../contact/">Contact</a>
                </li>
            
            
            
                <li >
                    <a href="../../about/">About</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../bare-metal-programming/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../links/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/tenbaht/sduino">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#performance">Performance</a></li>
        
            <li><a href="#comparing-code-size-with-the-original-avr-arduino">Comparing code size with the original AVR Arduino</a></li>
        
            <li><a href="#float-arithmetics">Float arithmetics</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="performance">Performance</h1>
<p>The STM8 backend for SDCC has improved a lot since the release of version
3.6.0 in June 2016. But due to the very small number of registers the code
size will almost always be bigger than for the AVR. Depending on the exact
application the difference is anywhere between negligible and factor two.</p>
<h2 id="comparing-code-size-with-the-original-avr-arduino">Comparing code size with the original AVR Arduino</h2>
<p>Benchmarking the original Arduino examples from Arduino 1.0.5. The simple
Blinky compiles to 57 bytes of code, the total binary including the sduino
libraries is 1868 Bytes (0x74c).</p>
<p>So far, wiring_analog depends on wiring_digital, even when analogWrite is not
used. This could be solved by compiling the sduino functions separately into
a library.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Code</th>
<th>Total</th>
<th>Linked files other than main and wiring</th>
</tr>
</thead>
<tbody>
<tr>
<td>01. Basics/</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>BareMinimum</td>
<td>2</td>
<td>1238</td>
<td>-</td>
</tr>
<tr>
<td>Blink</td>
<td>57</td>
<td>1870</td>
<td>wiring_digital</td>
</tr>
<tr>
<td>AnalogReadSerial</td>
<td>205</td>
<td>3452</td>
<td>digital, analog, serial, print</td>
</tr>
<tr>
<td>DigitalReadSerial</td>
<td>57</td>
<td>3160</td>
<td>digital, serial, print</td>
</tr>
<tr>
<td>Fade</td>
<td>226</td>
<td>2189</td>
<td>digital, analog</td>
</tr>
<tr>
<td>ReadAnalogVoltage</td>
<td></td>
<td></td>
<td>float not yet implemented</td>
</tr>
<tr>
<td>02. Digital/</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Debounce</td>
<td>192</td>
<td>2016</td>
<td>digital</td>
</tr>
</tbody>
</table>
<h2 id="float-arithmetics">Float arithmetics</h2>
<p>Floating point arithmetics is supported by the SDCC standard library, but it
comes at a pretty high cost in terms of code space and CPU load. This is how
much the generated code grows by using a single float operation compared to 
using a long int:</p>
<table>
<thead>
<tr>
<th>Floating point operation</th>
<th>approx. code size</th>
</tr>
</thead>
<tbody>
<tr>
<td>addition</td>
<td>736 Bytes</td>
</tr>
<tr>
<td>subtraction</td>
<td>754 Bytes</td>
</tr>
<tr>
<td>division</td>
<td>673 Bytes</td>
</tr>
<tr>
<td>multiplication</td>
<td>907 Bytes</td>
</tr>
<tr>
<td>sinf() or cosf()</td>
<td>3346 Bytes</td>
</tr>
<tr>
<td>log10f()</td>
<td>3437 Bytes</td>
</tr>
</tbody>
</table>
<p>The Arduino standard example '01. Basics/ReadAnalogVoltage' is a very simple
simple program with only very little floating point arithmetics. But it
already uses 7336 bytes of flash. A similar sketch using integer arithmetics
results in much more compact code occuping only 3791 bytes.</p>
<p>Float does work, but is better to be avoided and replaced by fixed point
arithmetics whenever possible.</p></div>
        </div>

	<footer class="col-md-12">
		<hr>
		
		<center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
	</footer>


        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>